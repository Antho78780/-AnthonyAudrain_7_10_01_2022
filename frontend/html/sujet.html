<!DOCTYPE html>
<html lang = "fr">
    <head>
        <title>profil Groupomania</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=500, initial-scale=1">  
        <link rel="stylesheet"  href="/frontend/css/style.css">
    </head>
    <body id="background">
        <section id="app">
            <form method="post">
                <div id="flex">
                    <p>{{ titreSujet }}</p>
                    <p class="size">{{ titreObligatoire }}</p>
                </div>
                    <input v-model="titre" type="text" id="titreForms">
            </form>
            <a href="#">{{photo}}</a>
            <form method="post">
                <p>{{  SujetArticle }}</p>
                <textarea  v-model="sujet" id="message"></textarea>
            </form>
            <button type="button"class="modifButton" @click="envoyerSujet">Envoyer</button>
        </section>
        <script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>
        <script>
            const app = new Vue({
                el: "#app",
                data: {
                    titreSujet: "Titre",
                    titreObligatoire: "Obligatoire",
                    SujetArticle: "Créer un nouveau sujet",
                    photo: "Ajouté une photo",
                    apiSujetCreate: "http://localhost:3000/sujetCreate",
                    
                    titre: "",
                    sujet: "",
                },
                methods: {
                    envoyerSujet() {
                        const recupStorage = JSON.parse(sessionStorage.getItem("usersIdToken"));
                        const userIdSujet = recupStorage[0]
                        const titre = this.titre;
                        const sujet = this.sujet;

                        if(titre == "" || sujet == "") {
                            alert("Vous ne pouvez pas envoyé de champs vide")
                        }
                        else {
                            const objetSujet = {titre, sujet, userIdSujet};
                            fetch (this.apiSujetCreate, {
                                method: "POST", 
                                headers: {
                                    'Content-Type' : 'application/json'
                                },
                                body: JSON.stringify(objetSujet)
                            })
                            .then((res) => {
                                if(res.ok) {
                                    window.location.href="accueil.html"
                                }
                            })
                        }
                    }
                }
            })
        </script>
    </body>
</html>